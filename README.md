<a name="mar-start"></a>
# Audio HighRes: MultiSpeaker Audio Repair & Emotional Speech Synthesis

**Audio HighRes** — это передовая платформа для текстовой и аудио обработки в синтеза речи с использованием мультиспикерного подхода и современных нейросетевых технологий. Наш проект объединяет обработку текста, работу с пунктуацией и синтез эмоциональной речи с высокой точностью, поддерживая адаптацию под индивидуальные голоса.

## Новые Возможности
- **Многоуровневая обработка аудио**:
  - Две модели (маленькая и большая) работают поэтапно для последовательного улучшения качества текста, извлеченного из аудио.
  - Поддерживается подача как аудио, так и текста для обработки.
- **Пунктуация**:
  - Модель пунктуации добавляет точные знаки препинания для улучшения читабельности текста.
- **Синтез речи с референсами**:
  - Интеграция с дообученной **XTTS2**, поддерживающей два типа референсов:
    - **Клонирующий референс**: Обеспечивает копирование тембра и особенностей голоса.
    - **Эмоциональный референс**: Передает нужный эмоциональный окрас речи.
  - Для работы с референсами достаточно всего **шести секунд** аудио.

## Особенности
- **Восстановление аудио**:
  - Улучшение качества поврежденных или шумных аудиофайлов с использованием современных нейросетей.
- **Мультиспикерное обучение**:
  - Обучение на данных от множества спикеров для лучшей адаптивности и обобщающей способности моделей.
- **Синтез эмоциональной речи**:
  - Уникальная система, создающая эмоционально насыщенную речь на основе пользовательских референсов.
- **Гибкость использования**:
  - Возможность интеграции в различные рабочие процессы благодаря модульному подходу.

## Содержание
- [Начало](#mar-start)
- [Структура проекта](#main-structure)
- [Установка](#rep-download)
- [Распределение задач](#task-distribution)
- [Ветки бригад](#git-rules-team)
- [Распределение задач по бригадам](#task-distribution-teams)
- [Календарь работы](#gantt)
- [Правила помощи бригад](#help-rules-team)
- [Рекомендации для бригад](#recomendation-team)
- [Работа с Git](#git-work)
- [Работа с GitHub Desk](#github-work)

<a name="main-structure"></a>
## Структура проекта

- `handlers/`: Обработчики для различных функций проекта, включая обработку текста, голоса и работы с референсами.
- `logs/`: Логи работы системы.
- `model/`: Директория с моделями, включая Vosk (для обработки аудио и текста) и другие.
- `recasepunc/`: Модуль для восстановления пунктуации в тексте.
- `utils/`: Вспомогательные утилиты, включая логирование.
- `XTTS-v2/`: Директория с дообученной моделью синтеза речи (XTTS) и её компонентами.

### Полная структура
- `prjda/`
  - `handlers/`:
    - `__init__.py`: Инициализация обработчиков.
    - `botton_handler.py`: Обработка кнопок.
    - `cancel_handler.py`: Обработка отмены операций.
    - `reference_handler.py`: Обработка аудио-референсов.
    - `synthesis_handler.py`: Обработка синтеза речи.
    - `text_handler.py`: Обработка текстовых запросов.
    - `voice_handler.py`: Обработка голосовых запросов.
  - `logs/`:
    - `bot.log`: Лог работы Telegram-бота.
  - `model/`:
    - `vosk-model-ru-0.42/`: Основная модель Vosk.
    - `vosk-model-small-ru-0.22/`: Упрощенная модель Vosk.
    - `vosk-recasepunc-ru-0.22/`: Модель для восстановления пунктуации.
  - `recasepunc/`:
    - `recasepunc.py`: Основной скрипт для обработки пунктуации.
    - `requirements.txt`: Зависимости для модуля.
    - `prepare.sh`: Скрипт подготовки данных.
    - `train.sh`: Скрипт для обучения модели пунктуации.
  - `utils/`:
    - `logger.py`: Скрипт для логирования.
  - `XTTS-v2/`:
    - `config.json`: Конфигурация для XTTS.
    - `model.pth`: Файлы модели XTTS.
    - `emotion_voice.wav`: Пример референсного аудио для эмоций.
    - `xtts_runner.py`: Основной скрипт запуска XTTS.

### Основные файлы
- `bot.py`: Основной файл Telegram-бота.
- `processing.py`: Основной скрипт для обработки входных данных.
- `requirements.txt`: Файл зависимостей проекта.
- `README.md`: Описание проекта.
- `voice.wav` и `voice.ogg`: Примеры голосовых файлов.

- [На старт](#mar-start)

<a name="rep-download"></a>
## Установка
1. Клонируйте репозиторий:
   ```sh
   git clone https://github.com/your-username/multispeaker-audio-repair.git
   cd multispeaker-audio-repair
- [На старт](#mar-start)

<a name="task-distribution"></a>
## Распределение задач

### Подготовка данных
- **Сбор данных**: Сбор аудиозаписей от разных спикеров.
- **Анализ и очистка данных**: Удаление шума и ненужных данных.
- **Разметка данных**: Создание текстовых транскриптов для аудиозаписей.
- **Аугментация данных**: Создание дополнительных данных с использованием техник аугментации.

### Разработка и обучение моделей
- **Разработка модели автоэнкодера**: Создание модели для восстановления аудио.
- **Разработка мультиспикерной модели**: Создание модели для мультиспикерного синтеза речи.
- **Интеграция моделей**: Интеграция автоэнкодера и мультиспикерной модели.

### Обучение и тестирование
- **Обучение моделей**: Обучение моделей на подготовленных данных.
- **Оценка моделей**: Оценка производительности моделей на тестовых данных.

### Разработка утилит и инструментов
- **Инструменты для обработки данных**: Разработка утилит для обработки и разметки данных.
- **Инструменты для обучения моделей**: Разработка утилит для обучения и оценки моделей.

### Документация и визуализация
- **Документация проекта**: Создание документации для проекта.
- **Визуализация результатов**: Создание визуализаций для представления результатов работы моделей.

### Развертывание и поддержка
- **Развертывание модели**: Развертывание модели на сервере или в облаке.
- **Поддержка и обновление модели**: Обеспечение поддержки и обновления модели.
- [На старт](#mar-start)


<a name="git-rules-team"></a>
## Правило использования Git для бригад

### Бригады и их ветки:

#### Бригада 1: Подготовка данных
- **Ветка:** `data-preparation`
- **Папки:**
  - `raw_data/`: сырые данные
  - `cleaned_data/`: очищенные данные

#### Бригада 2: Разметка и аугментация данных
- **Ветка:** `data-annotation`
- **Папки:**
  - `annotated_data/`: размеченные данные
  - `augmented_data/`: аугментированные данные

#### Бригада 3: Разработка моделей
- **Ветка:** `model-development`
- **Папки:**
  - `autoencoder/`: модели автоэнкодеров
  - `multispeaker/`: модели мультиспикерного синтеза

#### Бригада 4: Интеграция и тестирование моделей
- **Ветка:** `model-integration`
- **Папки:**
  - `integrated_models/`: интегрированные модели
  - `testing/`: тестирование моделей

#### Бригада 5: Документация и развертывание
- **Ветка:** `documentation-deployment`
- **Папки:**
  - `documentation/`: документация проекта
  - `deployment/`: файлы для развертывания моделей
- [На старт](#mar-start)


<a name="task-distribution-teams"></a>
## Распределение задач по бригадам

### Бригада 1: Подготовка данных

#### Сбор данных
**Задача**: Сбор аудиозаписей от разных спикеров.
- **Подсказки**:
  - Организуйте сессии записи в студии.
  - Найдите и пригласите различных спикеров для записи.
  - Используйте качественное оборудование для записи.
- **Источники информации**:
  - Руководства по записи звука.
  - Оборудование для записи звука (микрофоны, рекордеры).

#### Анализ и очистка данных
**Задача**: Удаление шума и ненужных данных.
- **Подсказки**:
  - Используйте фильтры для удаления шума.
  - Применяйте алгоритмы шумоподавления.
- **Источники информации**:
  - Библиотеки для обработки звука (например, librosa, Audacity).
  - Статьи и руководства по очистке аудиоданных.

### Бригада 2: Разметка и аугментация данных

#### Разметка данных
**Задача**: Создание текстовых транскриптов для аудиозаписей.
- **Подсказки**:
  - Используйте автоматические инструменты для транскрипции.
  - Проверяйте и исправляйте транскрипции вручную.
- **Источники информации**:
  - Инструменты для автоматической транскрипции (например, Google Speech-to-Text).
  - Руководства по транскрипции.

#### Аугментация данных
**Задача**: Создание дополнительных данных с использованием техник аугментации.
- **Подсказки**:
  - Применяйте техники изменения скорости, добавления шума и т.д.
- **Источники информации**:
  - Библиотеки для аугментации данных (например, audiomentations).
  - Статьи и руководства по аугментации аудиоданных.

### Бригада 3: Разработка моделей

#### Разработка модели автоэнкодера
**Задача**: Создание модели для восстановления аудио.
- **Подсказки**:
  - Изучите архитектуры автоэнкодеров.
  - Реализуйте модель на основе PyTorch.
- **Источники информации**:
  - Статьи и руководства по автоэнкодерам.
  - Документация PyTorch.

#### Разработка мультиспикерной модели
**Задача**: Создание модели для мультиспикерного синтеза речи.
- **Подсказки**:
  - Изучите архитектуры моделей для мультиспикерного синтеза.
  - Реализуйте модель на основе PyTorch.
- **Источники информации**:
  - Статьи и руководства по синтезу речи.
  - Документация PyTorch.

### Бригада 4: Интеграция и тестирование моделей

#### Интеграция моделей
**Задача**: Интеграция автоэнкодера и мультиспикерной модели.
- **Подсказки**:
  - Объедините модели в одну архитектуру.
  - Оптимизируйте совместную работу моделей.
- **Источники информации**:
  - Статьи и руководства по интеграции моделей.
  - Документация PyTorch.

#### Обучение моделей
**Задача**: Обучение моделей на подготовленных данных.
- **Подсказки**:
  - Настройте параметры обучения.
  - Запустите обучение моделей.
- **Источники информации**:
  - Документация PyTorch.
  - Статьи и руководства по обучению моделей.

### Бригада 5: Документация и развертывание

#### Документация проекта
**Задача**: Создание документации для проекта.
- **Подсказки**:
  - Описывайте каждый этап проекта.
  - Включайте примеры использования.
- **Источники информации**:
  - Примеры документации в других проектах.
  - Руководства по написанию документации.

#### Развертывание модели
**Задача**: Развертывание модели на сервере или в облаке.
- **Подсказки**:
  - Настройте окружение для развертывания.
  - Разверните модель для использования в реальных условиях.
- **Источники информации**:
  - Документация облачных сервисов (например, AWS, Azure).
  - Руководства по развертыванию моделей.
- [На старт](#mar-start)


<a name="gantt"></a>
## График выполнения проекта (Gantt диаграмма)
Бригады: Б1, Б2, Б3, Б4, Б5.

| Этап | Задачи | Сентябрь 2024 | Октябрь 2024 | Ноябрь 2024 | Декабрь 2024 | Январь 2025 | Февраль 2025 | Март 2025 | Апрель 2025 | Май 2025 |
|------|--------|---------------|--------------|-------------|--------------|-------------|--------------|-----------|-------------|----------|
| Подготовка данных | Сбор данных | x | x | | | | | | | |
| | Анализ и очистка данных | | x | x | | | | | | |
| | Разметка данных | | x | x | x | | | | | |
| | Аугментация данных | | | x | x | | | | | |
| Разработка и обучение моделей | Разработка модели автоэнкодера | | | x | x | | | | | |
| | Разработка мультиспикерной модели | | | x | x | x | | | | |
| | Интеграция моделей | | | | x | x | | | | |
| Обучение и тестирование | Обучение моделей | | | | | x | x | | | |
| | Оценка моделей | | | | | | x | x | | |
| Разработка утилит и инструментов | Инструменты для обработки данных | | | x | x | | | | | |
| | Инструменты для обучения моделей | | | x | x | x | | | | |
| Документация и визуализация | Документация проекта | | | | x | x | | | | |
| | Визуализация результатов | | | | | x | x | | | |
| Развертывание и поддержка | Развертывание модели | | | | | | x | x | | |
| | Поддержка и обновление модели | | | | | | | x | x | x |
- [На старт](#mar-start)


<a name="help-rules-team"></a>
# Правило помощи бригад

## Правило
Если бригада не справляется с задачей в срок, другая бригада начинает помогать ей, увеличивая сроки выполнения задачи. Приоритет задач меняется, и при выполнении просроченной задачи обе бригады переходят к текущей задаче бригады, которая оказывала помощь. Цель — обеспечить выполнение всех задач с минимальными задержками.

## Пример работы в существующих бригадах

### Сценарий
Бригада 2 (Разметка и аугментация данных) не успевает завершить задачу "Разметка данных" в срок.

### Действия

#### Обнаружение проблемы
- Бригада 2 сообщает о задержке.

#### Активизация помощи
- Бригада 1 (Подготовка данных) свободна и начинает помогать Бригаде 2.
- Сроки задачи "Разметка данных" увеличиваются на 20%.

#### Изменение приоритетов
- Задача "Разметка данных" становится приоритетной для обеих бригад.

#### Завершение задачи
- Бригада 1 и Бригада 2 совместно завершают задачу "Разметка данных".

#### Переход к следующей задаче
- Обе бригады переходят к текущей задаче Бригады 1 — "Сбор данных".

### Демонстрация на примере

#### Сначала
- Бригада 2 работает над "Разметкой данных".
- Бригада 1 работает над "Сбором данных".

#### При задержке
- Бригада 2 сообщает о невозможности завершить "Разметку данных" в срок.
- Бригада 1 приостанавливает "Сбор данных" и помогает с "Разметкой данных".
- Новый срок для "Разметки данных" устанавливается с увеличением на 20%.

#### После завершения
- "Разметка данных" завершена усилиями обеих бригад.
- Обе бригады переходят к задаче "Сбор данных".
- [На старт](#mar-start)


<a name="recomendation-team"></a>
## Рекомендации для каждой бригады

### Бригада 1: Подготовка данных

**Сбор данных:**
- Используйте высококачественное оборудование для записи аудио.
- Приглашайте разнообразных спикеров для получения различных образцов голоса.
- Проверяйте оборудование перед каждой сессией записи.

**Анализ и очистка данных:**
- Используйте фильтры для удаления фонового шума.
- Применяйте алгоритмы шумоподавления для улучшения качества данных.
- Проверяйте данные на наличие артефактов и других дефектов.

### Бригада 2: Разметка и аугментация данных

**Разметка данных:**
- Используйте автоматические инструменты для первичной транскрипции.
- Вручную проверяйте и исправляйте ошибки в транскрипциях.
- Соблюдайте стандарты разметки для обеспечения консистентности.

**Аугментация данных:**
- Применяйте техники изменения скорости, добавления шума и т.д.
- Сохраняйте оригинальные данные и аугментированные версии отдельно.
- Документируйте использованные методы аугментации для повторяемости.

### Бригада 3: Разработка моделей

**Разработка модели автоэнкодера:**
- Изучите различные архитектуры автоэнкодеров перед началом разработки.
- Используйте фреймворки, такие как PyTorch, для реализации модели.
- Проведите обширное тестирование модели на разных наборах данных.

**Разработка мультиспикерной модели:**
- Изучите существующие подходы к мультиспикерному синтезу речи.
- Реализуйте модель, учитывая особенности каждого спикера.
- Оптимизируйте модель для улучшения производительности и качества.

### Бригада 4: Интеграция и тестирование моделей

**Интеграция моделей:**
- Объедините автоэнкодеры и мультиспикерные модели в единую архитектуру.
- Обеспечьте совместимость моделей и оптимизацию их работы.
- Проведите интеграционные тесты для проверки работоспособности системы.

**Обучение моделей:**
- Настройте параметры обучения, чтобы избежать переобучения.
- Используйте разнообразные данные для обучения моделей.
- Мониторьте процесс обучения и корректируйте параметры по мере необходимости.

### Бригада 5: Документация и развертывание

**Документация проекта:**
- Детально описывайте каждый этап проекта.
- Включайте примеры использования и результаты тестирования.
- Поддерживайте документацию в актуальном состоянии.

**Развертывание модели:**
- Настройте серверное окружение для развертывания моделей.
- Обеспечьте безопасность и стабильность развернутой системы.
- Документируйте процесс развертывания для будущих обновлений и масштабирования.
- [На старт](#mar-start)


<a name="git-work"></a>
# Работа с Git

## Установка Git
Скачать и установить Git с [официального сайта](https://git-scm.com/).

## Клонирование репозитория
Откройте Git Bash и выполните команду:
```bash
git clone <URL_репозитория>
```
## Создание новой ветки
Переключитесь на ветку своей бригады:
```bash
git checkout -b <имя_ветки>
```
## Добавление изменений
Добавьте изменения в индекс:
```bash
git add .
```
## Коммит изменений
Сделайте коммит:
```bash
git commit -m "Описание изменений"
```
## Отправка изменений в удаленный репозиторий
Отправьте изменения в ветку своей бригады:
```bash
git push origin <имя_ветки>
```
## Объединение веток администратором
Администратор выполняет слияние веток в main:
```bash
git checkout main
git pull origin main
git merge <имя_ветки>
git push origin main
```
- [На старт](#mar-start)


<a name="github-work"></a>
# Работа с приложением GitHub

## Скачивание GitHub Desktop
Скачать и установить [GitHub Desktop](https://desktop.github.com/).

## Клонирование репозитория
В приложении GitHub Desktop выберите "Clone a repository from the Internet".
Введите URL репозитория и выберите папку для сохранения.

## Синхронизация изменений
Вносите изменения в локальные файлы.
В приложении GitHub Desktop добавьте изменения в индекс и сделайте коммит.
Нажмите "Push origin" для отправки изменений в удаленный репозиторий.

## Создание и переключение веток
В приложении GitHub Desktop выберите "Branch" и затем "New Branch", чтобы создать новую ветку.
Для переключения между ветками используйте меню веток.
- [На старт](#mar-start)
